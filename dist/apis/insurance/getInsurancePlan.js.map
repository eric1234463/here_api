{"version":3,"sources":["../../../src/apis/insurance/getInsurancePlan.js"],"names":["req","res","next","query","patientId","userAvgHealthRank","InsurancePlan","findOne","where","id","params","include","model","InsurancePlanAdvantage","InsuranceAdvantage","InsurancePlanDisadvantage","InsuranceDisadvantage","insurancePlan","json","dataValues","similarity","Math","ceil","rank","getInsurancePlan"],"mappings":";;;;;;;;;;;;;;;;;;AAAA;;;;AACA;;;;;;;sFAEe,iBAAgCA,GAAhC,EAAqCC,GAArC,EAA0CC,IAA1C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAEmB,sCAAuBF,IAAIG,KAAJ,CAAUC,SAAjC,CAFnB;;AAAA;AAEPC,6BAFO;AAAA;AAAA,mBAIe,iBAAOC,aAAP,CAAqBC,OAArB,CAA6B;AACvDC,qBAAO;AACLC,oBAAIT,IAAIU,MAAJ,CAAWD;AADV,eADgD;AAIvDE,uBAAS,CACP;AACEC,uBAAO,iBAAOC,sBADhB;AAEEF,yBAAS,CAAC,iBAAOG,kBAAR;AAFX,eADO,EAKP;AACEF,uBAAO,iBAAOG,yBADhB;AAEEJ,yBAAS,CAAC,iBAAOK,qBAAR;AAFX,eALO;AAJ8C,aAA7B,CAJf;;AAAA;AAIPC,yBAJO;;;AAoBbhB,gBAAIiB,IAAJ,4BACKD,cAAcE,UADnB;AAEEC,0BAAYC,KAAKC,IAAL,CACVjB,oBACEY,cAAcE,UAAd,CAAyBI,IAD3B,GAEE,GAHQ;AAFd;;AApBa;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,G;;WAAeC,gB;;;;SAAAA,gB","file":"getInsurancePlan.js","sourcesContent":["import models from \"../../../models\";\nimport getUserAvgHealthStatus from './getUserAvgHealthStatus';\n\nexport default async function getInsurancePlan(req, res, next) {\n\n  const userAvgHealthRank = await getUserAvgHealthStatus(req.query.patientId);\n\n  const insurancePlan = await models.InsurancePlan.findOne({\n    where: {\n      id: req.params.id\n    },\n    include: [\n      { \n        model: models.InsurancePlanAdvantage,\n        include: [models.InsuranceAdvantage]\n      },\n      {\n        model: models.InsurancePlanDisadvantage,\n        include: [models.InsuranceDisadvantage]\n      }\n    ]\n  });\n\n  res.json({\n    ...insurancePlan.dataValues,\n    similarity: Math.ceil(\n      userAvgHealthRank /\n        insurancePlan.dataValues.rank *\n        100\n    )\n  })\n}\n"]}